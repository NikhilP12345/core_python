# The K8s namespace in which the application will be deployed in. NOTE: This is
# only for name generation, and has no other guardrails or effects.
k8sNamespace: prod

# The deployment environment. Will also be passed as the environment variable
# `APP_ENV` to all pods.
deploymentEnv: prod

image:
  # Container image that hosts the celery application, with an entrypoint.sh script
  repository: gcr.io/master-270109/payment-management-helm/prod/prod
  pullPolicy: Always

  # Revision / version of the container image to use; do not use 'latest'
  tag: null # NOTE: To be passed with the --set flag during deployment

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations:
    iam.gke.io/gcp-service-account: prod-payment-management@master-270109.iam.gserviceaccount.com

# Shared environment variables for all pods
sharedEnv:
  DATASTORE_PROJECT: prod-payment-management
  GSM_PROJECT_ID: master-270109


# Configure the application server
server:
  enabled: true
  replicas: 2
  memoryRequest: "1Gi"
  cpuRequest: "1000m"
  memoryLimit: "1Gi"
  cpuLimit: "1000m"
  port: 8080
  healthCheck: /healthcheck


# Configure celery beat
beat:
  enabled: false
  memoryRequest: "0.5Gi"
  cpuRequest: "500m"
  memoryLimit: "0.5Gi"
  cpuLimit: "500m"
  storage: "10Gi"
  storageClassName: standard-rwo


# Configure the flower dashboard
flower:
  enabled: true
  memoryRequest: "1Gi"
  cpuRequest: "500m"
  memoryLimit: "1Gi"
  cpuLimit: "500m"
  storage: "10Gi"
  storageClassName: standard-rwo


  # Configure workers
worker:

  # Default number of workers for queues
  defaultReplicas: 2

  # Default mempory allocation for each worker
  defaultMemory: "1Gi"

  # Default CPU allocation for each worker
  defaultCPU: "1000m"

  # Queue-specific configuration
  ############################################################################
  # - queue: celery         # Name of the queue
  #   replicas: 1           # Number of replicas for the queue, optional
  #   memoryRequest: "1Gi"  # Amount of memory to request, optional
  #   cpuRequest: "500m"    # Amount of CPU to request, optional
  #   memoryLimit: "1Gi"    # Amount of memory to limit, optional
  #   cpuLimit: "500m"      # Amount of CPU to limit, optional
  ############################################################################
  queues:
    - queue: celery
      memoryRequest: "1Gi"
      cpuRequest: "1000m"
      memoryLimit: "1Gi"
      cpuLimit: "1000m"


# Events consumer details
eventsConsumer:
  enabled: true
  replicas: 1
  memoryRequest: "1Gi"
  cpuRequest: "1000m"
  memoryLimit: "1Gi"
  cpuLimit: "1000m"
